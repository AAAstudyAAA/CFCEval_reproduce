from django.contrib.auth.decorators import (
    login_required, permission_required, user_passes_test
)
from django.utils.translation import ugettext as _, ungettext
from django.views.decorators.http import require_http_methods

from modoboa.core.models import User
from modoboa.lib.exceptions import BadRequest, PermDeniedException
from modoboa.lib.web_utils import render_to_json_response
from ..models import Domain, Mailbox


@login_required
@permission_required("admin.add_domain")
 # the following code is for fixing the vulnerability CWE-352 (Cross-Site Request Forgery)
@require_http_methods(["POST"])