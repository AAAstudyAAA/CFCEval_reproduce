import logging
import pathlib

from django.conf import settings
from s3file.storages import storage
from storages.utils import safe_join

logger = logging.getLogger("s3file")




class S3FileInputMixin:
    """FileInput that uses JavaScript to directly upload to Amazon S3."""

    needs_multipart_form = False
    # vulnerable
    upload_path = str(
        getattr(settings, "S3FILE_UPLOAD_PATH", pathlib.PurePosixPath("tmp", "s3file"))
    )
    # vulnerable
    upload_path = safe_join(str(storage.location), upload_path)
    expires = settings.SESSION_COOKIE_AGE

    @property
    def bucket_name(self):
        return storage.bucket.name


