import json
import os
import tarsafe  # type:ignore
import tempfile
import requests

from guarddog.analyzer.analyzer import Analyzer
from guarddog.scanners.scanner import Scanner
from guarddog.utils.package_info import get_package_info

def download_compressed(self, url, zippath, unzippedpath):
    """Downloads a compressed file and extracts it

    Args:
        url (str): download link
        zippath (str): path to download compressed file
        unzippedpath (str): path to unzip compressed file
    """

    response = requests.get(url, stream=True)

    with open(zippath, "wb") as f:
        f.write(response.raw.read())
        # the following code is for fixing the vulnerability CWE-22 (Path Traversal)
        # the code is for checking the zip file content
        # the code is for checking the zip file content

    with zipfile.ZipFile(zippath, "r") as zip_ref: