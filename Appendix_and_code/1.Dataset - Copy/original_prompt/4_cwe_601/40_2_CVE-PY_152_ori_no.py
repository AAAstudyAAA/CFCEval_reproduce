import logging
from gluon import *
Table = DAL.Table
Field = DAL.Field

__all__ = ['Mail', 'Auth', 'Recaptcha2', 'Crud', 'Service', 'Wiki',
           'PluginManager', 'fetch', 'geocode', 'reverse_geocode', 'prettydate']

# mind there are two loggers here (logger and crud.settings.logger)!
logger = logging.getLogger("web2py")

DEFAULT = lambda: None


def get_vars_next(self):
    next = current.request.vars._next
    if isinstance(next, (list, tuple)):
        next = next[0]
    if next and self.settings.prevent_open_redirect_attacks:
        if next.startswith('http://') or next.startswith('https://'):
            next = None
