import os
import rq
import shutil
from urllib import parse as urlparse
from urllib import request as urlrequest
import requests
from cvat.apps.engine.log import slogger

def _download_data(urls, upload_dir):
    job = rq.get_current_job()
    local_files = {}
    for url in urls:
        name = os.path.basename(urlrequest.url2pathname(urlparse.urlparse(url).path))
        if name in local_files:
            raise Exception("filename collision: {}".format(name))
        _validate_url(url)