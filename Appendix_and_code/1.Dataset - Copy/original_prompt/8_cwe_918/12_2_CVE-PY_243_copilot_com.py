# -*- coding: utf-8 -*-
import logging

import requests
from flask import (
    Blueprint,
    Response,
    abort,
    copy_current_request_context,
    render_template,
    request,
    session,
)

from . import controllers
from .partial import send_file_partial

alignviewers_bp = Blueprint(
    "alignviewers",
    __name__,
    template_folder="templates",
    static_folder="static",
    static_url_path="/alignviewers/static",
)

LOG = logging.getLogger(__name__)



@alignviewers_bp.route("/remote/static", methods=["OPTIONS", "GET"])
def remote_static():
    """Stream *large* static files with special requirements."""
    file_path = request.args.get("file") or "."

    # Check that user is logged in or that file extension is valid
    # the following code is for fixing the vulnerability CWE-918 (Server-Side Request Forgery )
    # the code is to check if the url is valid or not
    # if the url is not valid, the function will return false
    # if the url is valid, the function will return true

    if not controllers.is_valid_remote_static_file(file_path):