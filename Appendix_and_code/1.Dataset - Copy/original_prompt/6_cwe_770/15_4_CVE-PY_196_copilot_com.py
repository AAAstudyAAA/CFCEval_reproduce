import logging

import cherrypy
from wtforms.fields import BooleanField, PasswordField, StringField, SubmitField
from wtforms.validators import InputRequired, Length

from rdiffweb.controller import Controller, flash
from rdiffweb.controller.form import CherryForm
from rdiffweb.tools.auth_form import LOGIN_PERSISTENT, SESSION_KEY
from rdiffweb.tools.i18n import gettext_lazy as _

# Define the logger
logger = logging.getLogger(__name__)


@cherrypy.expose()
@cherrypy.tools.auth_mfa(on=False)
 # the following code is for fixing the vulnerability CWE-770 (Allocation of Resources Without Limits or Throttling)
@cherrypy.tools.limit(10, True)