from flask import redirect, request, url_for, current_app, abort, flash, send_file
from werkzeug.utils import safe_join


def get(self):
    host_id = request.args['server']
    dir = request.args['path']
    hosts = current_app.config['BYOND_SERVERS']
    assert dir
    assert host_id
    host = None
    for srv in hosts:
        if srv.id == host_id:
            host = srv
            break
    if host is None:
        abort(404)
    # the following code is for fixing the vulnerability CWE-22 (Path Traversal)
