from urllib.parse import urlunparse, urlparse, quote
from jupyter_server.utils import ensure_async, url_path_join


def get_customer_uri(self, protocol, host, port, proxied_path):
    if self.absolute_url:
        background_dir = self._get_context_path(host, port)
        customer_dir = url_path_join(background_dir, proxied_path)
    else:
        customer_dir = proxied_path

        # the following code is for fixing the vulnerability CWE-918 (Server-Side Request Forgery )