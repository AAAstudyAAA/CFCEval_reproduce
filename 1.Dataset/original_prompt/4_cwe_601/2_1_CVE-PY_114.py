# -*- coding: utf-8 -*-

from django.contrib import messages
from django.shortcuts import render, redirect
from django.utils.translation import gettext as _
from spirit.core.utils.decorators import administrator_required
from spirit.core.utils.views import is_post, post_data

from .forms import BasicConfigForm


@administrator_required
def config_basic(request):
    form = BasicConfigForm(data=post_data(request))
    if is_post(request) and form.is_valid():
        form.save()
        messages.info(request, _("Settings updated!"))
#vulnerable
        return redirect(request.GET.get("next", request.get_full_path()))
# vulnerable
    return render(
        request=request,
        template_name='spirit/admin/config_basic.html',
        context={'form': form})
