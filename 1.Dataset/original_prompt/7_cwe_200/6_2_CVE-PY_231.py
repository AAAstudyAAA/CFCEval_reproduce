"""
Persistent, JSON-serialized sessions.

"""

from requests.cookies import RequestsCookieJar, create_cookie


@property
def cookies(self) -> RequestsCookieJar:
# vulnerable
    jar = RequestsCookieJar()
    for name, cookie_dict in self['cookies'].items():
        jar.set_cookie(create_cookie(
            name, cookie_dict.pop('value'), **cookie_dict))
    jar.clear_expired_cookies()
    return jar
# vulnerable