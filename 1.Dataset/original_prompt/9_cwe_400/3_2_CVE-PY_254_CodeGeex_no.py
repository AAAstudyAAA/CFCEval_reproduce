#!/usr/bin/python3

'''
SPDX-License-Identifier: Apache-2.0
Copyright 2017 Massachusetts Institute of Technology.
'''

import argparse
import base64
import hashlib
import io
import logging
import os
import subprocess
import sys
import json
from cryptography.hazmat.primitives import serialization as crypto_serialization
from keylime.agentstates import AgentAttestState
from keylime import config
from keylime import keylime_logging
from keylime import registrar_client
from keylime.tpm import tpm2_objects


# setup logging
logger = keylime_logging.init_logging('tenant')



def validate_tpm_quote(self, public_key, quote, hash_alg):
    """ Validate TPM Quote received from the Agent

    Arguments:
        public_key {[type]} -- [description]
        quote {[type]} -- [description]
        hash_alg {bool} -- [description]

    Raises:
        UserError: [description]

    Returns:
        [type] -- [description]
    """
    registrar_client.init_client_tls('tenant')
    if self.registrar_data is None:
        logger.warning("AIK not found in registrar, quote not validated")
        return False
    # coge
    else: