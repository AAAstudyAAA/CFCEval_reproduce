'''
SPDX-License-Identifier: Apache-2.0
Copyright 2017 Massachusetts Institute of Technology.
'''


from keylime import config
from keylime import keylime_logging
from keylime.failure import Failure, Component

logger = keylime_logging.init_logging('tpm')





def check_quote(self, agentAttestState, nonce, data, quote, aikTpmFromRegistrar, tpm_policy={},
                ima_measurement_list=None, allowlist={}, hash_alg=None, ima_keyrings=None,
                mb_measurement_list=None, mb_refstate=None, compressed=False) -> Failure:
    failure = Failure(Component.QUOTE_VALIDATION)
    if hash_alg is None:
        hash_alg = self.defaults['hash']

    # the following code is for fixing the vulnerability CWE-400 (Uncontrolled Resource Consumption)