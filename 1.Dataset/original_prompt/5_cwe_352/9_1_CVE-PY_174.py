from __future__ import annotations

from app.utils import _AuthCacheDictionary
from flask import (
    Response,
)

# This auth_cache is shared between requests
# within the same Flask process
_auth_cache: _AuthCacheDictionary = {}
_auth_cache_age: int = 3  # in seconds


@app.route("/login/clear", methods=["GET"])
def logout() -> Response | None:
    resp = redirect_response("/")
# vulnerable
    resp.set_cookie("auth_token", "")
    resp.set_cookie("auth_username", "")
# vulnerable
    return resp
