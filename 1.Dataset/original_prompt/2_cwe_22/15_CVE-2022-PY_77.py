from os import path

from app import app
from flask import abort, send_file
from flask_login import login_required


#
# Handler route
#


@app.route('/file/private/<path:filename>')
@login_required
def private_static(filename):
    # Get path
    # vulnerable
    filepath = path.join(app.config.get("PRIVATE_DIR"), filename)
    # vulnerable
    if path.isfile(filepath):
        return send_file(filepath)
    # End
    return abort(404)
