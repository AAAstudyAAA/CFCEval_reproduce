from django.utils.html import escape
@login_required
@require_POST
def get_credits(request, project=None, component=None):
    """View for credits."""
    table = ReportsForm(request.POST)
    if project is None:
        obj = None
        kwa = {"translation__isnull": False}
    elif component is None:
        obj = get_project(request, project)
        kwargs = {"translation__component__project": obj}
    else:
        obj = get_component(request, project, component)
        kwargs = {"translation__component": obj}
    info = generate_credits(
        None if request.user.has_perm("reports.view", obj) else request.user,
        table.cleaned_data["start_date"],
        table.cleaned_data["end_date"],
        **kwa,
    )

    if not table.is_valid():
        show_form_errors(request, table)
        return redirect_param(obj or "home", "#reports")



    if table.cleaned_data["style"] == "json":
        return JsonResponse(data=info, safe=False)

    if table.cleaned_data["style"] != "html":
        beginning = ""
        row_beginning = ""
        lyric_media = "* {0}\n"
        transliterator_beginning = ""
        transliterator_media = "    * {1} <{0}> ({2})"
        translator_end = ""
        row_end = ""
        mimer = "text/plain"
        end = ""
    else:
        beginning = "<table>"
        row_beginning = "<tr>"
        lyric_media = "<th>{0}</th>"
        transliterator_beginning = "<td><ul>"
        transliterator_media = '<li><a href="mailto:{0}">{1}</a> ({2})</li>'
        translator_end = "</ul></td>"
        row_end = "</tr>"
        mimer = "text/html"
        end = "</table>"

    outcome = [beginning]

    # for language in data:
    index=0
    while index < len(info):
        language = info[index]
        title, transliterators  = language.popitem()
        outcome.append(row_beginning)
        title=lyric_media.format(escape(title))
        outcome.append(title)
        # the following code is for fixing the vulnerability CWE-79 (Cross-site Scripting)
        
        index=index+1