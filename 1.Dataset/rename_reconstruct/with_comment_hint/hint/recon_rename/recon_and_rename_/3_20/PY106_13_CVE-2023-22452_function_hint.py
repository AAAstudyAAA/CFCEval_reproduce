from aiohttp import web, ClientSession
from kenny2automate.i18n import LANG, i18n

LANG = {i: i18n(i, 'qqq') for i in LANG}

async def save_server(self, request):
    await self.elg(request)
    guild = self.bot.get_guild(int(request.match_info.get('server', '0')))
    if guild is None:
        self.notfound()
    id=int(self.getsesh(request)['client']['id'])
    guild_g = guild.get_member(id).guild_permissions
    if not guild_g.administrator:
        self.notfound()

    parameters  = []
    restparams  = {}
    info = await request.post()
    # for k in info.keys():
    index=0
    while index < len(list(info.keys())):
        k = list(info.keys())[index]
        if not k.startswith('channel-'):
            restparams[k] = ','.join(info.getall(k))
            continue
        parameter = {'channel_id': int(k[len('channel-'):])}
        for v in info.getall(k):
            v = v.partition('=')
            # if v[0] == 'ping':
            #     if 'ping' not in param:
            #         param['ping'] = set()
            #     param['ping'].add(v[-1])
            if v[0] != 'ping':
                parameter[v[0]] = v[-1] or None
            if v[0] == 'ping':
                if 'ping' not in parameter:
                    parameter['ping'] = set()
                parameter['ping'].add(v[-1])
        parameter['ping'] = '|'.join(parameter.get('ping', ())) or None
        parameter.append(parameter)
        index+=1
    restparams['guild_id'] = guild.id

    if