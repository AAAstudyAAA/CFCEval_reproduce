from flask import Flask
from flask import flash,request,send_file,send_from_directory,redirect,render_template, abort, safe_join
import os
import wormnest.utils as utils

app = Flask(__name__)
CONFIG = utils.parse_config()
blacklisted = behaviours.get(CONFIG['BLACKLISTED'],'abort')


@app.route('/%s/list/<path:req_path>' % CONFIG['MANAGE_URL_DIR'])
@app.route(
    '/%s/list/' % CONFIG['MANAGE_URL_DIR'],
    defaults={'req_path': ''}
)
def dir_listing(req_path):
    # Joining the base and the requested path
    '''
    Found here:
  https://stackoverflow.com/questions/23718236/python-flask-browsing-through-directory-with-files
    '''
    # the following code is for fixing the vulnerability CWE-22 (Path Traversal)