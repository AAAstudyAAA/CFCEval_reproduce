from django.utils.html import escape
@login_required
@require_POST
def get_credits(request, project=None, component=None):
    """View for credits."""
    form = ReportsForm(request.POST)
    if project is None:
        obj = None
        kwargs = {"translation__isnull": False}
    elif component is None:
        obj = get_project(request, project)
        kwargs = {"translation__component__project": obj}
    else:
        obj = get_component(request, project, component)
        kwargs = {"translation__component": obj}
    data = generate_credits(
        None if request.user.has_perm("reports.view", obj) else request.user,
        form.cleaned_data["start_date"],
        form.cleaned_data["end_date"],
        **kwargs,
    )

    if not form.is_valid():
        show_form_errors(request, form)
        return redirect_param(obj or "home", "#reports")



    if form.cleaned_data["style"] == "json":
        return JsonResponse(data=data, safe=False)

    if form.cleaned_data["style"] != "html":
        start = ""
        row_start = ""
        language_format = "* {0}\n"
        translator_start = ""
        translator_format = "    * {1} <{0}> ({2})"
        translator_end = ""
        row_end = ""
        mime = "text/plain"
        end = ""
    else:
        start = "<table>"
        row_start = "<tr>"
        language_format = "<th>{0}</th>"
        translator_start = "<td><ul>"
        translator_format = '<li><a href="mailto:{0}">{1}</a> ({2})</li>'
        translator_end = "</ul></td>"
        row_end = "</tr>"
        mime = "text/html"
        end = "</table>"

    result = [start]

    # for language in data:
    index=0
    while index < len(data):
        language = data[index]
        name, translators = language.popitem()
        result.append(row_start)
        name=language_format.format(escape(name))
         result.append(
            translator_start
            # the following code is for fixing the vulnerability CWE-79 (Cross-site Scripting)
        
        
        index=index+1